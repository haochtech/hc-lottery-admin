{template 'public/header'}

{template 'public/comhead'}

<link rel="stylesheet" type="text/css" href="../addons/yzcj_sun/template/public/ygcss.css">
<link rel="stylesheet" type="text/css" href="../addons/yzcj_sun/template/public/datetimepicker.min.css">

<style type="text/css">

    #ygsinput{font-size: 14px;height: 33px;border-radius: 4px;border:1px solid #e7e7eb;padding-left: 10px;}
    #ygsinput1{font-size: 14px;height: 33px;border-radius: 4px;border:1px solid #e7e7eb;padding-left: 10px;}
    .searchname{font-size: 14px;color: #666;width: 226px;}
    .searchname1{font-size: 14px;color: #666;width: 226px;}
    .searchname>a>p{color: #666;}
    .searchname1>a>p{color: #666;}
    .switch:before{
        opacity: 0;
    }
</style>
<ul class="nav nav-tabs">    
    <span class="ygxian"></span>
    <div class="ygdangq">当前位置:</div>
    <li class="active"><a href="javascript:void(0);">礼物添加</a></li>
    <li><a href="{php echo $this->createWebUrl('gifts');}"><i class="fa fa-refresh"></i>返回礼物列表</a></li>
</ul>
<div class="main ygmain">
    <form action="" method="post" class="form-horizontal form" enctype="multipart/form-data">
        <div class="panel panel-default ygdefault">
            <div class="panel-heading wyheader">
                礼物添加
            </div>
            <div class="panel-body">
                <div class="form-group" >
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">礼物类型选择</label>
                    <div class="col-sm-9">
                        <select class="col-sm-4" name="type">
                            <option value="0">请选择礼物类型</option>
                            {loop $type $key $item}
                                {if $item['id']==$info['type']}
                                  <option value="{$item['id']}" selected="selected" name="type">{$item['type']}</option>
                                {else}
                                  <option value="{$item['id']}" name="type">{$item['type']}</option>
                                {/if}
                            {/loop}
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">赞助商选择</label>
                    <div class="col-sm-9">
                        <select class="col-sm-4" id="sid" name="sid">
                            <option value="0">请选择赞助商</option>
                            {loop $sponsor $key $item}
                            {if $item['sid']==$info['sid']}
                              <option value="{$item['sid']}" selected="selected" name="sid">{$item['sname']}</option>
                            {else}
                              <option value="{$item['sid']}" name="sid">{$item['sname']}</option>
                            {/if}
                            {/loop}
                        </select>
                        <span class="btn btn-sm storeblue" data-toggle="modal" data-target="#myModal1" style="margin-left: 30px;">搜索赞助商</span>
                        <div class="col-xs-12 col-sm-9 col-md-10 col-sm-push-3 col-md-push-2 ">
                            <span class="help-block">*请手动选择发起赞助商，未选择则由平台发布。注意！！</span>
                            <span class="help-block">*注意！！发送礼物的赞助商必须要绑定用户，不然用户购买礼物的钱无法进账！</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label gname1">礼物名称</label>
                    <div class="col-sm-9">
                        <input class="form-control" name='gname' value="{$info['gname']}">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">单价</label>
                    <div class="col-sm-9">
                        <input class="form-control" name='price' value="{$info['price']}"></input>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">库存（个）</label>
                    <div class="col-sm-9">
                        <input class="form-control" name='count' value="{$info['count']}"></input>
                    </div>
                </div>
                <div class="form-group" style="width: 90%;margin-left: 15px;">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">礼物简介</label>
                    <div class="col-sm-10">
                        <textarea name="lottery" class="form-control" cols="30" rows="7">{$info['lottery']}</textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">礼物详情</label>
                    <div class="col-sm-9">
                        {php echo tpl_ueditor('content',$info['content']);}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">礼物轮播图</label>
                    <div class="col-sm-9">
                       {php echo tpl_form_field_multi_image('pic',$pic);}
                       <span class="help-block">*建议尺寸大小:630*630px</span>
                    </div>
                </div>

      </div>
  </div>
        <div class="form-group">
            <input type="submit" name="submit" value="确定" class="btn col-lg-3" style="color: white;background-color: #444444;margin-left: 550px;"/>
            <input type="hidden" name="token" value="{$_W['token']}" />
             <input type="hidden" name="id" value="{$info['id']}" />
        </div>
        <div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                      <h4 class="modal-title" id="myModalLabel" style="font-size: 20px;">提示</h4>
                    </div>
                    <div class="modal-body ygsearch" style="font-size: 20px;padding: 15px 30px;">
                        <input type="text" id="ygsinput" placeholder="请输入赞助商名称">
                        <span class="btn btn-sm ygbtn storeblue">搜索</span>
                        <div class="searchname" style="margin-top: 8px;"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<script src="../addons/yzcj_sun/template/public/datetimepicker.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
   
    $(function(){
        $(".form-datetime").datetimepicker(
        {
            weekStart: 1,
            todayBtn:  1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            forceParse: 0,
            showMeridian: 1,
            format: "yyyy-mm-dd hh:ii"
        });
    
        $("#frame-15").show();
        $("#yframe-15").addClass("wyactive");
        $(".searchname").hide();
        $(".ygbtn").on("click",function(){
            var ygsinput = $("#ygsinput").val();

            if(ygsinput.length==''){
              $(".searchname").html('');
            }else{
              $(".searchname").html('')  
              var keywords = $("#ygsinput").val()
              // console.log(keywords);
              $.ajax({
                  type:"post",
                  url:"{$_W['siteroot']}/app/index.php?i={$_W['uniacid']}&c=entry&do=FindSponsor&m=yzcj_sun",
                  dataType:"text",
                  data:{keywords:keywords},
                  dataType:'JSON',
                  success:function(data){
                    console.log(data);
                    if (data['num']==10001) {
                        var data = data['msg'];
                        $(".searchname").show();
                        for(var i=0;i<data.length;i++){
                          if(data[i].sname){
                             $(".searchname").append('<div class="shnbox" data-dismiss="modal" id="'+data[i].sid+'"><a href="javascript:void(0);"><p>'+data[i].sname+'</p></a></div>')
                          }
                          
                        }
                        $(".shnbox").each(function(){
                          $(this).click(function(){
                              var thid = $(this).attr("id");
                              console.log(thid)
                              $('#sid option[value='+thid+']').attr("selected", true);
                          })
                        })
                    }else if(data['num']==10002) {
                        $(".searchname").show();
                        $(".searchname").append('<div class="shnbox" data-dismiss="modal"><a href="javascript:void(0);"><p>'+data['msg']+'</p></a></div>')
                    }
                  }
              }) 
            }
        })

    })
</script>